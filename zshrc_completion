# Completion
fpath=(~/.zsh.d/completion ${fpath})
autoload -U compinit
compinit

local default='%{[m%}'
local red='%{[1;31m%}'
local green='%{[1;32m%}'
local yellow='%{[1;33m%}'
local blue='%{[1;34m%}'
local purple='%{[1;35m%}'
local cyan='%{[1;36m%}'
local white='%{[1;37m%}'

# zstyle ':completion:*:default' format $red'%d'$default
zstyle ':completion:*:default' format "$yellow%d$default"
zstyle ':completion:*:messages' format "$yellow%d$default"
zstyle ':completion:*:warnings' format "${red}No matches for: $yellow%d$default"
zstyle ':completion:*:descriptions' format "${red}<%d>${default}"
zstyle ':completion:*:corrections' format "$yellow%d$red(errors: %3)$default"
# zstyle ':completion:*:options' format $blue'%d'$default

zstyle ':completion:*' group-name ''

zstyle ':completion:*:default' menu select=2

## 補完候補に色を付ける。
### "": 空文字列はデフォルト値を使うという意味。
zstyle ':completion:*:default' list-colors ""
# zstyle ':completion:*' list-colors 'di=34' 'ln=35' 'so=32' 'ex=31' 'bd=46;34' 'cd=43;34'
# zstyle ':completion:*:default' list-colors 'di=34' 'ln=35' 'so=32' 'ex=31' 'bd=46;34' 'cd=43;34'

## 補完候補がなければより曖昧に候補を探す。
### m:{a-z}={A-Z}: 小文字を大文字に変えたものでも補完する。
### r:|[._-]=*: 「.」「_」「-」の前にワイルドカード「*」があるものとして補完する。
# zstyle ':completion:*' matcher-list 'm:{a-z}={A-Z} r:|[._-]=*'

## 補完方法の設定。指定した順番に実行する。
### _oldlist 前回の補完結果を再利用する。
### _complete: 補完する。
### _match: globを展開しないで候補の一覧から補完する。
### _history: ヒストリのコマンドも補完候補とする。
### _ignored: 補完候補にださないと指定したものも補完候補とする。
### _approximate: 似ている補完候補も補完候補とする。
### _prefix: カーソル以降を無視してカーソル位置までで補完する。
zstyle ':completion:*' completer \
        _oldlist _complete _match _history _ignored _approximate _prefix

## 補完候補をキャッシュする。
zstyle ':completion:*' use-cache yes
## 詳細な情報を使う。
zstyle ':completion:*' verbose yes
## sudo時にはsudo用のパスも使う。
zstyle ':completion:sudo:*' environ PATH="$SUDO_PATH:$PATH"

## カーソル位置で補完する。
setopt complete_in_word
## globを展開しないで候補の一覧から補完する。
setopt glob_complete
## 補完時にヒストリを自動的に展開する。
setopt hist_expand
## 辞書順ではなく数字順に並べる。
setopt numeric_glob_sort
